{
  "hash": "0c67b6015829f02386a011aa44409b6c",
  "result": {
    "markdown": "---\ntitle: \"Tidyverse\"\nauthor: \"Harshitha Viswanath\"\n---\n\n\n\n#Loading Libraries---------\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-1_111d7f83800974bd3b05986c7a7928ff'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#> ✔ dplyr     1.1.2     ✔ readr     2.1.4\n#> ✔ forcats   1.0.0     ✔ stringr   1.5.0\n#> ✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n#> ✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n#> ✔ purrr     1.0.1     \n#> ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n#> ✖ dplyr::filter() masks stats::filter()\n#> ✖ dplyr::lag()    masks stats::lag()\n#> ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(tibble)\nlibrary(readr)\nlibrary(dplyr)\nlibrary(magrittr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> \n#> Attaching package: 'magrittr'\n#> \n#> The following object is masked from 'package:purrr':\n#> \n#>     set_names\n#> \n#> The following object is masked from 'package:tidyr':\n#> \n#>     extract\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidyr)\nlibrary(stringr)\nlibrary(ggplot2)\nlibrary(readxl)\nlibrary(lubridate)\n```\n:::\n\n#Importing Files---------\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-2_4f70bbf5ad6f965bc1535af1beb32531'}\n\n```{.r .cell-code}\nbikes_tbl  <-  read_excel(path = \"C:/Users/49157/Desktop/BM1_repo/ss23-bdsb-HarshithaViswanath2608/assets/Tidyverse_data/bikes.xlsx\")\norderlines_tbl   <-  read_excel(path = \"C:/Users/49157/Desktop/BM1_repo/ss23-bdsb-HarshithaViswanath2608/assets/Tidyverse_data/orderlines.xlsx\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> New names:\n#> • `` -> `...1`\n```\n:::\n\n```{.r .cell-code}\nbikeshops_tbl   <-   read_excel(path = \"C:/Users/49157/Desktop/BM1_repo/ss23-bdsb-HarshithaViswanath2608/assets/Tidyverse_data/bikeshops.xlsx\")\n```\n:::\n\n#Examining Data---------\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-3_d759682b09e842f9628ad060b116ec71'}\n\n```{.r .cell-code}\nglimpse(bikes_tbl)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Rows: 231\n#> Columns: 9\n#> $ bike.id        <dbl> 2875, 2873, 2874, 2876, 2877, 2225, 2091, 2086, 2088, 2…\n#> $ model          <chr> \"Aeroad CF SL Disc 8.0 Di2\", \"Aeroad CF SLX Disc 9.0 ET…\n#> $ model.year     <dbl> 2020, 2020, 2020, 2020, 2020, 2019, 2019, 2021, 2020, 2…\n#> $ frame.material <chr> \"carbon\", \"carbon\", \"carbon\", \"carbon\", \"carbon\", \"carb…\n#> $ weight         <dbl> 7.60, 7.27, 7.10, 7.73, 7.83, 6.80, 6.80, 7.60, 7.30, 7…\n#> $ price          <dbl> 4579, 6919, 6429, 5069, 3609, 6139, 5359, 2629, 3699, 3…\n#> $ category       <chr> \"Road - Race - Aeroad\", \"Road - Race - Aeroad\", \"Road -…\n#> $ gender         <chr> \"unisex\", \"unisex\", \"unisex\", \"unisex\", \"unisex\", \"unis…\n#> $ url            <chr> \"https://www.canyon.com/en-de/road-bikes/race-bikes/aer…\n```\n:::\n\n```{.r .cell-code}\nglimpse(orderlines_tbl)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Rows: 15,644\n#> Columns: 7\n#> $ ...1        <chr> \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"…\n#> $ order.id    <dbl> 1, 1, 2, 2, 3, 3, 3, 3, 3, 4, 5, 5, 5, 5, 6, 6, 6, 6, 7, 7…\n#> $ order.line  <dbl> 1, 2, 1, 2, 1, 2, 3, 4, 5, 1, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2…\n#> $ order.date  <dttm> 2015-01-07, 2015-01-07, 2015-01-10, 2015-01-10, 2015-01-1…\n#> $ customer.id <dbl> 2, 2, 10, 10, 6, 6, 6, 6, 6, 22, 8, 8, 8, 8, 16, 16, 16, 1…\n#> $ product.id  <dbl> 2681, 2411, 2629, 2137, 2367, 1973, 2422, 2655, 2247, 2408…\n#> $ quantity    <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1…\n```\n:::\n\n```{.r .cell-code}\nglimpse(bikeshops_tbl)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Rows: 30\n#> Columns: 5\n#> $ bikeshop.id <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,…\n#> $ name        <chr> \"Zum Goldenen Lenker\", \"AlexandeRad\", \"Fahrradladen 16\", \"…\n#> $ location    <chr> \"Berlin, Berlin\", \"Hamburg, Hamburg\", \"Munich, Bavaria\", \"…\n#> $ lat         <dbl> 52.51667, 53.57532, 48.15000, 50.93333, 50.11552, 48.78234…\n#> $ lng         <dbl> 13.400000, 10.015340, 11.583333, 6.950000, 8.684167, 9.180…\n```\n:::\n:::\n\n#Left Join of tables bikes_tbl and bikeshops_tbl with orderlines_tbl to obtain location, price and quantity---------\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-4_c8503940ec5d163d624051deb01f75f3'}\n\n```{.r .cell-code}\nbike_orderlines_joined_tbl   <-   orderlines_tbl   %>%\n  left_join(bikes_tbl, by = c(\"product.id\" = \"bike.id\"))  %>%\n  left_join(bikeshops_tbl, by = c(\"customer.id\" = \"bikeshop.id\"))\n#bike_orderlines_joined_tbl\n```\n:::\n\n#Data Wrangling to obtain the bike model under category with addition of total price ---------\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-5_96bcf97a9ab2e1826283f0d93d9d470c'}\n\n```{.r .cell-code}\nbike_orderlines_wrangled_tbl <- bike_orderlines_joined_tbl %>% \n separate(col = location,\n           into = c(\"city\",\"state\"),\n           sep = \", \",\n           convert = T) %>%\n  separate(col    = category,\n           into   = c(\"category.1\", \"category.2\", \"category.3\"),\n           sep    = \" - \") %>%\n  \n  \n  mutate(total_price = price * quantity)\n#glimpse(bike_orderlines_wrangled_tbl)\n```\n:::\n\n#State with the highest revenue---------\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-6_b28b7456ea0c14ea651e4101115f8a26'}\n\n```{.r .cell-code}\nsales_by_location_tbl  <-  bike_orderlines_wrangled_tbl %>%\n  select(state, total_price) %>%\n  group_by(state) %>%\n  summarize(sales = sum(total_price)) %>%\n  mutate(sales_text = scales::dollar(sales, big.mark = \".\",\n                                     decimal.mark = \",\",\n                                     prefix = \"\",\n                                     suffix = \"€\"))\n\n\nglimpse(sales_by_location_tbl)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Rows: 12\n#> Columns: 3\n#> $ state      <chr> \"Baden-Württemberg\", \"Bavaria\", \"Berlin\", \"Bremen\", \"Hambur…\n#> $ sales      <dbl> 6521090, 6742819, 1128433, 10653499, 3874756, 1558901, 4107…\n#> $ sales_text <chr> \"6.521.090€\", \"6.742.819€\", \"1.128.433€\", \"10.653.499€\", \"3…\n```\n:::\n\n```{.r .cell-code}\nsales_by_location_tbl %>%\n  ggplot(aes(x = state, y = sales)) +\n  \n  geom_col(fill = \"#2DC6D6\") +\n  geom_label(aes(label = sales_text)) +\n  geom_smooth(method = \"lm\", se = FALSE)+\n  scale_y_continuous( labels = scales::dollar_format(big.mark = \".\",\n                                                     decimal.mark = \",\",\n                                                     prefix = \"\",\n                                                     suffix = \" €\")) +\n  \n  labs(\n    title = \"Revenue by Location(State)\",\n    subtitle = \"North Rhine-Westphalia has the highest revenue\",\n    x = \"\",\n    y = \"Revenue\"\n  ) + theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> `geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](01_tidyverse_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n#Analysing sales by location and year using facet_wrap---------\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-7_672dd4c232469d8040808911c5f5790b'}\n\n```{.r .cell-code}\nsales_by_location_cat_1_tbl <- bike_orderlines_wrangled_tbl %>%\n  select(state, total_price, category.1) %>%\n  group_by(state, category.1) %>%\n  summarise(sales = sum(total_price)) %>%\n  ungroup() %>%\n  mutate(sales_text = scales::dollar(sales, big.mark = \".\", \n                                     decimal.mark = \",\", \n                                     prefix = \"\", \n                                     suffix = \" €\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> `summarise()` has grouped output by 'state'. You can override using the\n#> `.groups` argument.\n```\n:::\n\n```{.r .cell-code}\nsales_by_location_cat_1_tbl\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"state\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"category.1\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"sales\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sales_text\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"Baden-Württemberg\",\"2\":\"E-Bikes\",\"3\":\"1181225\",\"4\":\"1.181.225 €\"},{\"1\":\"Baden-Württemberg\",\"2\":\"Gravel\",\"3\":\"488482\",\"4\":\"488.482 €\"},{\"1\":\"Baden-Württemberg\",\"2\":\"Hybrid / City\",\"3\":\"295390\",\"4\":\"295.390 €\"},{\"1\":\"Baden-Württemberg\",\"2\":\"Mountain\",\"3\":\"2130319\",\"4\":\"2.130.319 €\"},{\"1\":\"Baden-Württemberg\",\"2\":\"Road\",\"3\":\"2425674\",\"4\":\"2.425.674 €\"},{\"1\":\"Bavaria\",\"2\":\"E-Bikes\",\"3\":\"1205624\",\"4\":\"1.205.624 €\"},{\"1\":\"Bavaria\",\"2\":\"Gravel\",\"3\":\"554532\",\"4\":\"554.532 €\"},{\"1\":\"Bavaria\",\"2\":\"Hybrid / City\",\"3\":\"294366\",\"4\":\"294.366 €\"},{\"1\":\"Bavaria\",\"2\":\"Mountain\",\"3\":\"2084694\",\"4\":\"2.084.694 €\"},{\"1\":\"Bavaria\",\"2\":\"Road\",\"3\":\"2603603\",\"4\":\"2.603.603 €\"},{\"1\":\"Berlin\",\"2\":\"E-Bikes\",\"3\":\"223168\",\"4\":\"223.168 €\"},{\"1\":\"Berlin\",\"2\":\"Gravel\",\"3\":\"54897\",\"4\":\"54.897 €\"},{\"1\":\"Berlin\",\"2\":\"Hybrid / City\",\"3\":\"59518\",\"4\":\"59.518 €\"},{\"1\":\"Berlin\",\"2\":\"Mountain\",\"3\":\"377447\",\"4\":\"377.447 €\"},{\"1\":\"Berlin\",\"2\":\"Road\",\"3\":\"413403\",\"4\":\"413.403 €\"},{\"1\":\"Bremen\",\"2\":\"E-Bikes\",\"3\":\"1819014\",\"4\":\"1.819.014 €\"},{\"1\":\"Bremen\",\"2\":\"Gravel\",\"3\":\"882131\",\"4\":\"882.131 €\"},{\"1\":\"Bremen\",\"2\":\"Hybrid / City\",\"3\":\"577570\",\"4\":\"577.570 €\"},{\"1\":\"Bremen\",\"2\":\"Mountain\",\"3\":\"3192900\",\"4\":\"3.192.900 €\"},{\"1\":\"Bremen\",\"2\":\"Road\",\"3\":\"4181884\",\"4\":\"4.181.884 €\"},{\"1\":\"Hamburg\",\"2\":\"E-Bikes\",\"3\":\"732649\",\"4\":\"732.649 €\"},{\"1\":\"Hamburg\",\"2\":\"Gravel\",\"3\":\"216934\",\"4\":\"216.934 €\"},{\"1\":\"Hamburg\",\"2\":\"Hybrid / City\",\"3\":\"212391\",\"4\":\"212.391 €\"},{\"1\":\"Hamburg\",\"2\":\"Mountain\",\"3\":\"1283793\",\"4\":\"1.283.793 €\"},{\"1\":\"Hamburg\",\"2\":\"Road\",\"3\":\"1428989\",\"4\":\"1.428.989 €\"},{\"1\":\"Hesse\",\"2\":\"E-Bikes\",\"3\":\"294888\",\"4\":\"294.888 €\"},{\"1\":\"Hesse\",\"2\":\"Gravel\",\"3\":\"102856\",\"4\":\"102.856 €\"},{\"1\":\"Hesse\",\"2\":\"Hybrid / City\",\"3\":\"55213\",\"4\":\"55.213 €\"},{\"1\":\"Hesse\",\"2\":\"Mountain\",\"3\":\"498873\",\"4\":\"498.873 €\"},{\"1\":\"Hesse\",\"2\":\"Road\",\"3\":\"607071\",\"4\":\"607.071 €\"},{\"1\":\"Lower Saxony\",\"2\":\"E-Bikes\",\"3\":\"726733\",\"4\":\"726.733 €\"},{\"1\":\"Lower Saxony\",\"2\":\"Gravel\",\"3\":\"319733\",\"4\":\"319.733 €\"},{\"1\":\"Lower Saxony\",\"2\":\"Hybrid / City\",\"3\":\"219255\",\"4\":\"219.255 €\"},{\"1\":\"Lower Saxony\",\"2\":\"Mountain\",\"3\":\"1283833\",\"4\":\"1.283.833 €\"},{\"1\":\"Lower Saxony\",\"2\":\"Road\",\"3\":\"1557561\",\"4\":\"1.557.561 €\"},{\"1\":\"Mecklenburg-Western Pomerania\",\"2\":\"E-Bikes\",\"3\":\"122128\",\"4\":\"122.128 €\"},{\"1\":\"Mecklenburg-Western Pomerania\",\"2\":\"Gravel\",\"3\":\"25610\",\"4\":\"25.610 €\"},{\"1\":\"Mecklenburg-Western Pomerania\",\"2\":\"Hybrid / City\",\"3\":\"29597\",\"4\":\"29.597 €\"},{\"1\":\"Mecklenburg-Western Pomerania\",\"2\":\"Mountain\",\"3\":\"147938\",\"4\":\"147.938 €\"},{\"1\":\"Mecklenburg-Western Pomerania\",\"2\":\"Road\",\"3\":\"293701\",\"4\":\"293.701 €\"},{\"1\":\"North Rhine-Westphalia\",\"2\":\"E-Bikes\",\"3\":\"3589849\",\"4\":\"3.589.849 €\"},{\"1\":\"North Rhine-Westphalia\",\"2\":\"Gravel\",\"3\":\"1449880\",\"4\":\"1.449.880 €\"},{\"1\":\"North Rhine-Westphalia\",\"2\":\"Hybrid / City\",\"3\":\"947440\",\"4\":\"947.440 €\"},{\"1\":\"North Rhine-Westphalia\",\"2\":\"Mountain\",\"3\":\"6856560\",\"4\":\"6.856.560 €\"},{\"1\":\"North Rhine-Westphalia\",\"2\":\"Road\",\"3\":\"8356884\",\"4\":\"8.356.884 €\"},{\"1\":\"Saxony\",\"2\":\"E-Bikes\",\"3\":\"370290\",\"4\":\"370.290 €\"},{\"1\":\"Saxony\",\"2\":\"Gravel\",\"3\":\"79364\",\"4\":\"79.364 €\"},{\"1\":\"Saxony\",\"2\":\"Hybrid / City\",\"3\":\"122992\",\"4\":\"122.992 €\"},{\"1\":\"Saxony\",\"2\":\"Mountain\",\"3\":\"748611\",\"4\":\"748.611 €\"},{\"1\":\"Saxony\",\"2\":\"Road\",\"3\":\"908988\",\"4\":\"908.988 €\"},{\"1\":\"Saxony-Anhalt\",\"2\":\"E-Bikes\",\"3\":\"101323\",\"4\":\"101.323 €\"},{\"1\":\"Saxony-Anhalt\",\"2\":\"Gravel\",\"3\":\"40307\",\"4\":\"40.307 €\"},{\"1\":\"Saxony-Anhalt\",\"2\":\"Hybrid / City\",\"3\":\"31510\",\"4\":\"31.510 €\"},{\"1\":\"Saxony-Anhalt\",\"2\":\"Mountain\",\"3\":\"184152\",\"4\":\"184.152 €\"},{\"1\":\"Saxony-Anhalt\",\"2\":\"Road\",\"3\":\"212322\",\"4\":\"212.322 €\"},{\"1\":\"Schleswig-Holstein\",\"2\":\"E-Bikes\",\"3\":\"585449\",\"4\":\"585.449 €\"},{\"1\":\"Schleswig-Holstein\",\"2\":\"Gravel\",\"3\":\"185204\",\"4\":\"185.204 €\"},{\"1\":\"Schleswig-Holstein\",\"2\":\"Hybrid / City\",\"3\":\"147976\",\"4\":\"147.976 €\"},{\"1\":\"Schleswig-Holstein\",\"2\":\"Mountain\",\"3\":\"1001373\",\"4\":\"1.001.373 €\"},{\"1\":\"Schleswig-Holstein\",\"2\":\"Road\",\"3\":\"1304747\",\"4\":\"1.304.747 €\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nsales_by_location_cat_1_tbl %>%\n  ggplot(aes(x = category.1, y = sales, fill = state)) +\n  geom_col() +\n  geom_smooth(method = \"lm\", se = FALSE)+\n  facet_wrap(~ state) +\n  scale_y_continuous(labels = scales::dollar_format(big.mark = \".\", \n                                                    decimal.mark = \",\", \n                                                    prefix = \"\", \n                                                    suffix = \" €\")) +\n  labs(\n    title = \"Revenue by category and state\",\n    subtitle = \"Trend in sales of products in each state\",\n    fill = \"State List\"\n  )+ theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> `geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](01_tidyverse_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}